<form [formGroup]="cicloEvaRecordForm" (ngSubmit)="submit()">
    <h1 mat-dialog-title>{{ title }}</h1>
    <p>{{ description }}</p>
    <mat-divider></mat-divider>   
    <mat-dialog-content>
        <div class="container mt-4">
            <div class="row">
                <h3 class="subTitle">Datos generales</h3>
                <mat-form-field appearance="outline" class="col-md-5">                        
                    <mat-label>Nombre de los ciclo de evaluación</mat-label>
                    <input appInputRestriction="APLHA_NUMERIC" matInput name="cicloEvaluacion" #cicloEvaluacion formControlName="cicloEvaluacion" [maxLength]="100" />
                    <mat-error *ngIf="cicloEvaRecordForm.get('cicloEvaluacion').hasError('noWhitespace')">
                        Este campo es obligatorio
                    </mat-error>    
                    <mat-error *ngIf="cicloEvaRecordForm.get('cicloEvaluacion').hasError('maxlength')">
                        El valor máximo de caracteres es 100
                    </mat-error>
                </mat-form-field>
                <div appearance="outline" class="col-md-5">
                    <mat-label *ngIf="data.nombreArchivo"> Imagen </mat-label>
                    <!--
                    <app-upload-azure [nameImage]="cicloEvaRecordForm.get('cicloEvaluacion').value"></app-upload-azure>
                    -->
                    <span class="chips" *ngIf="data.nombreArchivo">{{data.nombreArchivo}} <mat-icon class="icon-close" (click)="deleteFile(data.urlArchivo)">cancel</mat-icon></span>
                    <ngx-file-drag-drop *ngIf="!data.nombreArchivo" required emptyPlaceholder="Imagen: Arrastre aquí*"
                    class="mt-1 Drag_Style" activeBorderColor="#3F51B5" [multiple]="false" formControlName="imagenCiclo"
                    (valueChanged)="fileValidation($event)"></ngx-file-drag-drop>
                    <ng-container *ngIf="!data.nombreArchivo">
                        <span class="loadIma">Carga máxima 1MB 375x300px (*.jpg, *.jpeg, *.png)</span>
                    </ng-container>
                    <mat-error *ngIf="errFile" class="errFont">
                        {{errFile}}
                    </mat-error>
                </div>
                <div appearance="outline" class="col-md-2">
                    <mat-label> {{estatus}} </mat-label>
                    <mat-slide-toggle [checked]="estatusRecord" #activo formControlName="activo" (change)="changeStatusDescription($event)"></mat-slide-toggle> 
                </div>
            </div>
            <div class="row">
                <mat-form-field appearance="outline" class="col-md-3">
                    <mat-label>Procesos de evaluación</mat-label>  
                    <mat-select formControlName="procesoEvaluacionId" #procesoEvaluacionId>
                        <mat-option>Selecciona</mat-option>
                        <mat-option *ngFor="let row of procesos" [value]="row.id">
                            {{row.nombre}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field appearance="outline" class="col-md-3">
                    <mat-label>Institución</mat-label>  
                    <mat-select formControlName="institucionId" #institucionId>
                        <mat-option>Selecciona</mat-option>
                        <mat-option *ngFor="let row of instituciones" [value]="row.id">
                            {{row.clave}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field appearance="outline" class="col-md-3">
                    <mat-label>Año</mat-label>
                    <mat-select formControlName="anio" #anio>
                        <mat-option>Selecciona</mat-option>
                        <mat-option *ngFor="let year of anios" [value]="year">
                            {{year}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field appearance="outline" class="col-md-3">
                    <mat-label>Ciclo</mat-label>  
                    <mat-select formControlName="ciclo" #ciclo>
                        <mat-option>Selecciona</mat-option>
                        <mat-option *ngFor="let row of ciclos" [value]="row">
                            {{row}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
           <!-- Buscar Ciclo Anterior --> 
            <div class="row mb-2">
                <h3 class="subTitle">Ciclo anterior</h3>
                <p class="mb-2" *ngIf="procesoEvaluacionId.value && institucionId.value">Busca y selecciona el ciclo anterior 
                    <span class="buscarCiclo" (click)="buscarCicloAnterior(cicloEvaRecordForm.get('procesoEvaluacionId').value, cicloEvaRecordForm.get('institucionId').value)">
                        <mat-icon class="icon-search">search</mat-icon> Buscar
                    </span>
                    <span class="buscarCiclo" (click)="quitarCicloAnterior()">
                        <mat-icon class="icon-search">delete</mat-icon> Eliminar
                    </span>
                </p>
                <mat-form-field appearance="outline" class="col-md-6">                        
                    <mat-label>Nombre del ciclo anterior</mat-label>
                    <input appInputRestriction="APLHA_NUMERIC" matInput name="nombreCicloAnterior" #nombreCicloAnterior formControlName="nombreCicloAnterior" />
                    <input type="hidden" name="cicloAnteriorId" #cicloAnteriorId formControlName="cicloAnteriorId" />
                </mat-form-field>
                <mat-form-field appearance="outline" class="col-md-3">                        
                    <mat-label>Año</mat-label>
                    <input appInputRestriction="APLHA_NUMERIC" matInput name="anioAnterior" #anioAnterior formControlName="anioAnterior" />
                </mat-form-field>
                <mat-form-field appearance="outline" class="col-md-3">                        
                    <mat-label>Ciclo</mat-label>
                    <input appInputRestriction="APLHA_NUMERIC" matInput name="cicloAnterior" #cicloAnterior formControlName="cicloAnterior" />
                </mat-form-field>
            </div>
            <!-- /Buscar Ciclo Anterior -->
            <div class="row">
                <h3 class="subTitle">Etapa de evaluación</h3>
                <p>Ingresa las fechas correspondientes a cada etapa de evaluación</p>
            </div>
            <div class="row">
                <h3 class="col-md-4 vertical"></h3>
                <h3 class="col-md-4 vertical text-center subTitle">Regular</h3>
                <h3 class="col-md-4 vertical text-center subTitle">Extemporáneo</h3>
            </div>
            <!--
                <div class="row" *ngFor="let etapa of etapas">
                    <p class="col-md-4 px-2 vertical">{{etapa.etapaId}} {{etapa.claveEtapa}}: {{etapa.etapa}}</p>
                    <mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                        <mat-label>Fecha inicio - Fecha fin</mat-label>
                        <mat-date-range-input [rangePicker]="date">
                            <input matStartDate formControlName="fechaInicio{{etapa.etapaId}}R" placeholder="Fecha inicio">
                            <input matEndDate formControlName="fechaFin{{etapa.etapaId}}R" placeholder="Fecha fin" (dateChange)="resetFinE1R()">
                        </mat-date-range-input>
                        <mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint>
                        <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
                        <mat-date-range-picker #date></mat-date-range-picker>
                    </mat-form-field>
                </div>
            -->
           
            <div class="row">
                <div class="col-md-4 etapas-title">
                    <p class="col-md-12 px-2 vertical etapas-lists" *ngFor="let etapa of etapas; let i = index">
                        <span *ngIf="i < 8">
                            {{etapa.claveEtapa}}: {{etapa.etapa}}
                        </span>
                    </p>
                    <!--p class="col-md-12 px-2 vertical etapas-lists">&nbsp;</p-->
                </div>
                <div class="col-md-8">
                    <!-- 1 - ETAPA 1-->
                    <div class="row ">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser igual o mayor al día en que se registra. La fecha final debe ser igual o mayor a la fecha inicial.">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE1R">
                                <input matStartDate formControlName="fechaInicioE1R" #fecInicioE1R placeholder="Fecha inicio" >
                                <input matEndDate formControlName="fechaFinE1R" #fecFinE1R placeholder="Fecha fin" (dateChange)="resetFinE(2)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE1R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE1R></mat-date-range-picker>
                        </mat-form-field>
        
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE1E">
                              <input matStartDate formControlName="fechaInicioE1E" #fecInicioE1E placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE1E" #fecFinE1E placeholder="Fecha fin" >
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE1E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE1E></mat-date-range-picker>
                        </mat-form-field>
                        <div class="col-md-6"></div>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa1ErrorE" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha inicial de captura de metas (Etapa 1).
                            </mat-error>
                        </div>
                    </div>
                    <!-- 2 - ETAPA 2-->                   
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser igual o mayor a la fecha inicial de captura de metas (Etapa 1). La fecha final debe ser igual a la fecha final de la Revisión de la Autoevaluación.">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE2R">
                              <input matStartDate formControlName="fechaInicioE2R" #fecInicioE2R placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE2R" #fecFinE2R placeholder="Fecha fin" (dateChange)="resetFinE(2)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE2R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE2R></mat-date-range-picker>                            
                        </mat-form-field>
                        <!--mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [rangePicker]="dateE2E">
                              <input matStartDate formControlName="fechaInicioE2E" placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE2E" placeholder="Fecha fin" (dateChange)="resetFinE1R()">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="dateE2E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE2E></mat-date-range-picker>
                        </mat-form-field-->
                        <mat-error *ngIf="Etapa2Error" class="errFont">
                            *La fecha inicial debe ser igual o mayor a la fecha final de captura de metas (Etapa 1).
                        </mat-error>
                    </div>
                    <!-- 3 - ETAPA 3-->
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser mayor a la fecha final de captura de metas (Etapa 1). La fecha final debe ser mayor a la fecha inicial de captura de resultados.">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE3R">
                              <input matStartDate formControlName="fechaInicioE3R" #fecInicioE3R placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE3R" #fecFinE3R placeholder="Fecha fin"  (dateChange)="resetFinE(3)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE3R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE3R></mat-date-range-picker>
                        </mat-form-field>
        
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE3E">
                              <input matStartDate formControlName="fechaInicioE3E" #fecInicioE3E placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE3E" #fecFinE3E placeholder="Fecha fin">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE3E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE3E></mat-date-range-picker>
                        </mat-form-field>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa3Error" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha final de captura de metas (Etapa 1).
                            </mat-error>
                        </div>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa3ErrorE" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha final Captura de Resultados (Etapa 3).
                            </mat-error>
                        </div>
                    </div>
                    <!-- 4 - ETAPA 4-->
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser mayor a la fecha final de captura de resultados. La fecha final debe ser mayor a la fecha inicial de autoevaluación.">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE4R">
                              <input matStartDate formControlName="fechaInicioE4R" #fecInicioE4R placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE4R" #fecFinE4R placeholder="Fecha fin" (dateChange)="resetFinE(4)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE4R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE4R></mat-date-range-picker>
                        </mat-form-field>
        
                        <!--mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [rangePicker]="dateE4E">
                              <input matStartDate formControlName="fechaInicioE4E" placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaInicioE4E"  placeholder="Fecha fin" (dateChange)="resetFinE1R()">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="dateE4E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE4E></mat-date-range-picker>
                        </mat-form-field-->
                        <mat-error *ngIf="Etapa4Error" class="errFont">
                            *La fecha inicial debe ser mayor a la fecha final de captura de resultados.
                        </mat-error>
                    </div>
                    <!-- 5 - ETAPA 5-->
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser mayor a la fecha final de Autoevaluación. La fecha final debe ser mayor a la fecha inicial de revisión de autoevaluación.">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE5R">
                              <input matStartDate formControlName="fechaInicioE5R" #fecInicioE5R placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE5R" #fecFinE5R placeholder="Fecha fin" (dateChange)="resetFinE(5)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE5R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE5R></mat-date-range-picker>
                        </mat-form-field>
        
                        <!--mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [rangePicker]="dateE5E">
                              <input matStartDate formControlName="fechaInicioE5E" placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE5E" placeholder="Fecha fin" (dateChange)="resetFinE1R()">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="dateE5E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE5E></mat-date-range-picker>
                        </mat-form-field-->
                        <mat-error *ngIf="Etapa5Error" class="errFont">
                            *La fecha inicial debe ser mayor a la fecha final de Autoevaluación..
                        </mat-error>
                    </div>
                    <!-- 6 -ETAPA 6-->
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser mayor a la fecha final de la Revisión de la Autoevaluación. La fecha final debe ser mayor a la fecha inicial del plan de mejora (Diseño).">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE6R">
                              <input matStartDate formControlName="fechaInicioE6R" #fecInicioE6R placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE6R" #fecFinE6R placeholder="Fecha fin" (dateChange)="resetFinE(6)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE6R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE6R></mat-date-range-picker>
                        </mat-form-field>
        
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE6E">
                              <input matStartDate formControlName="fechaInicioE6E" #fecInicioE6E placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE6E" #fecFinE6E placeholder="Fecha fin" >
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE6E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE6E></mat-date-range-picker>
                        </mat-form-field>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa6Error" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha final de la Revisión de la Autoevaluación.
                            </mat-error>
                        </div>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa6ErrorE" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha final Plan de mejora (Diseño).
                            </mat-error>
                        </div>
                    </div>
                    <!-- 7 - ETAPA 6-->
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser mayor a la fecha final del Plan de mejora (Diseño). La fecha final debe ser mayor a la fecha inicial de plan de mejora (Ejecución).">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE7R">
                              <input matStartDate formControlName="fechaInicioE7R" #fecInicioE7R placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE7R" #fecFinE7R placeholder="Fecha fin" (dateChange)="resetFinE(7)">
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE7R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE7R></mat-date-range-picker>
                        </mat-form-field>
        
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [min]="today" [rangePicker]="dateE7E">
                              <input matStartDate formControlName="fechaInicioE7E" #fecInicioE7E placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE7E" #fecFinE7E placeholder="Fecha fin" >
                            </mat-date-range-input>
                            <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
                            <mat-datepicker-toggle matSuffix [for]="dateE7E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE7E></mat-date-range-picker>
                        </mat-form-field>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa7Error" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha final del Plan de mejora (Diseño).
                            </mat-error>
                        </div>
                        <div class="col-md-6">
                            <mat-error *ngIf="Etapa7ErrorE" class="errFont">
                                *La fecha inicial debe ser mayor a la fecha final Plan de mejora (Ejecución).
                            </mat-error>
                        </div>
                    </div>
                    <!-- 8 - ETAPA 7-->
                    <div class="row">
                        
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser igual o mayor a la fecha de la captura de metas.">
                            <mat-label>Fecha inicio</mat-label>
                            <input matInput [min]="today" [matDatepicker]="dateIE8R" formControlName="fechaInicioE8R" #fecInicioE8R placeholder="Fecha inicio">
                            <mat-datepicker-toggle matIconSuffix [for]="dateIE8R"></mat-datepicker-toggle>
                            <mat-datepicker #dateIE8R></mat-datepicker>
                        </mat-form-field>
                    
                        <!--mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha inicial debe ser igual o mayor a la fecha de la captura de metas. La fecha fin queda abierta, pero debe ser mayor a la fecha final de plan de mejora (Ejecución).">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [rangePicker]="dateE8R">
                              <input matStartDate formControlName="fechaInicioE8R" placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE8R" placeholder="Fecha fin" (dateChange)="resetFinE1R()">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="dateE8R"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE8R></mat-date-range-picker>
                        </mat-form-field-->
        
                        <!--mat-form-field appearance="outline" class="col-md-6" matTooltip="">
                            <mat-label>Fecha inicio - Fecha fin</mat-label>
                            <mat-date-range-input [rangePicker]="dateE8E">
                              <input matStartDate formControlName="fechaInicioE8E" placeholder="Fecha inicio">
                              <input matEndDate formControlName="fechaFinE8E" placeholder="Fecha fin" (dateChange)="resetFinE1R()">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="dateE8E"></mat-datepicker-toggle>
                            <mat-date-range-picker #dateE8E></mat-date-range-picker>
                        </mat-form-field-->
                        <mat-error *ngIf="Etapa8Error" class="errFont">
                            *La fecha inicial debe ser igual o mayor a la fecha de la captura de metas.
                        </mat-error>
                    </div>
                    <div class="row">
                        <mat-form-field appearance="outline" class="col-md-6" matTooltip="La fecha fin queda abierta, pero debe ser mayor a la fecha final de plan de mejora (Ejecución).">
                            <mat-label>Fecha fin</mat-label>
                            <input matInput [matDatepicker]="dateFE8R" formControlName="fechaFinE8R" #fecFinE8R placeholder="Fecha fin">
                            <mat-datepicker-toggle matIconSuffix [for]="dateFE8R"></mat-datepicker-toggle>
                            <mat-datepicker #dateFE8R></mat-datepicker>
                        </mat-form-field>
                        <mat-error *ngIf="Etapa8ErrorF" class="errFont">
                            **La fecha fin queda abierta, pero debe ser mayor a la fecha final de plan de mejora (Ejecución).
                        </mat-error>
                    </div>                    
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <p class="subTitle px-0 mx-0">Carga formato PM/CLM</p>
                    <span class="chips" *ngIf="data.nombreArchivoFpm">{{data.nombreArchivoFpm}} <mat-icon class="icon-close" (click)="deleteFileFpm(data.fpmArchivoId)">cancel</mat-icon></span>
                    <ngx-file-drag-drop *ngIf="!data.nombreArchivoFpm" required emptyPlaceholder="Arrastra aquí el archivo o selecciona"
                    class="mt-1 Drag_Style" activeBorderColor="#3F51B5" [multiple]="false" formControlName="formatoCiclo"
                    (valueChanged)="fileValidationFormat($event)"></ngx-file-drag-drop>
                    <ng-container *ngIf="!data.nombreArchivoFpm">
                        <span class="loadIma">Carga máxima 20MB (*.jpg, *.jpeg, *.png, *.pdf, *.docx, *.xlsx, *.pptx, *.txt)</span>
                    </ng-container>
                    <mat-error *ngIf="errFileFpm" class="errFont">
                        {{errFileFpm}}
                    </mat-error>
                </div>
            </div>
              
        </div>
    </mat-dialog-content>
    <mat-dialog-actions align="center" class="pb-2 text-center">
        <button *ngIf="!mode" type="submit" mat-raised-button class="mt-3" [disabled]="!fecFinE8R.value" color="primary">Guardar</button>
        <button *ngIf="mode" type="submit" mat-raised-button class="mt-3"  color="primary" [disabled]="!edit || errorFile1 || errorFile2 || (   
            !cicloEvaluacion || !anio || !ciclo ||
            !fecInicioE1R.value || !fecFinE1R.value ||
            !fecInicioE2R.value || !fecFinE2R.value ||
            !fecInicioE3R.value || !fecFinE3R.value ||
            !fecInicioE4R.value || !fecFinE4R.value ||
            !fecInicioE5R.value || !fecFinE5R.value ||
            !fecInicioE6R.value || !fecFinE6R.value || 
            !fecInicioE7R.value || !fecFinE7R.value || 
            !fecInicioE8R.value || !fecFinE8R.value
            )">Guardar</button>
        <button type="button" mat-raised-button class="mt-3" (click)="closeModalByConfimation()">Cancelar</button>
    </mat-dialog-actions>
</form>