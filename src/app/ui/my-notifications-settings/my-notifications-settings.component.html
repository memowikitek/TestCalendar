<mat-drawer-container class="example-container" [hasBackdrop]="true">
  <mat-drawer #drawer mode="over" position="end" class="box-sidenav">
    <form [formGroup]="FilterForm">
      <p>Elegir parámetros</p>
      <mat-form-field appearance="outline" class="col-md-10" matTooltip="">
        <mat-label>Rango de fechas</mat-label>
        <mat-date-range-input [min]="limitDate" [rangePicker]="date">
            <input matStartDate formControlName="fechaInicio" #fecInicioE1R placeholder="" >
            <input matEndDate formControlName="fechaFin" #fecFinE1R placeholder="">
        </mat-date-range-input>
        <!--mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint-->
        <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
        <mat-date-range-picker #date></mat-date-range-picker>
    </mat-form-field>
      <ng-container>
        <mat-form-field appearance="outline">
          <mat-label>Campus</mat-label>
          <mat-select multiple formControlName="campus" (selectionChange)="onSelectionChange($event,'campus')">
            <mat-option [value]="0" *ngIf="listaCampus" (click)="toggleAllSelection('campus')">Todos</mat-option>
            <mat-option *ngFor="let row of listaCampus" [value]="row.id">{{row.nombre}}</mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>
      <ng-container>
        <mat-form-field appearance="outline">
          <mat-label>Área Responsable</mat-label>
          <mat-select multiple formControlName="areaResp" (selectionChange)="onSelectionChange($event,'areaResp')">
            <mat-option [value]="0" *ngIf="listaAR" (click)="toggleAllSelection('areaResp')">Todos</mat-option>
            <mat-option *ngFor="let row of listaAR" [value]="row.id">{{row.nombre}}</mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>
      <ng-container>
        <mat-form-field appearance="outline">
          <mat-label>Estatus</mat-label>
          <mat-select multiple formControlName="estatus" (selectionChange)="onSelectionChange($event,'estatus')">
            <!--mat-option [value]="0" (click)="toggleAllSelection('estatus')">Todos</mat-option-->
            <mat-option *ngFor="let row of listaEstatus" [value]="row.id">{{row.descripcion}}</mat-option>
         </mat-select>
        </mat-form-field>
      </ng-container>
      <div class="container-btn-params">
        <button type="button" mat-raised-button class="mat-secundary" (click)="drawer.toggle()">Cancelar</button>
        <button type="button" mat-raised-button color="primary" (click)="aplicarFiltro()">Aplicar</button>
      </div>
      <div class="text-center">
        <button type="button" mat-raised-button (click)="btnCleanFilters('all')">Limpiar Filtros</button>
      </div>
    </form>
  </mat-drawer>
  <mat-drawer-content>
    <app-breadcrumbs></app-breadcrumbs>
    <div style="height: 88vh">
      <main [class]="'px-4 pb-4'">
        <div class="content p-0">
          <div class="row">
            <app-title title="Configuración de notificaciones" desc=""></app-title>
            <mat-divider></mat-divider>
          </div>
          <div class="row mt-4">
            <div class="col-lg-6 col-12">
              <button type="button" mat-raised-button color="primary" (click)="openRecord()" class="btn-text mt-3">
                <mat-icon>add</mat-icon>
                Nueva notificación
              </button>
            </div>
            <mat-form-field appearance="outline" class="col-lg-6 col-12 mt-1 pl-2">
              <mat-label>Buscar por título o ciclo de evaluación</mat-label>
              <!-- <input type="text" matInput #input name="busqueda" formControlName="busqueda" (keyup)="applyFilter($event)" /> -->
              <input type="text" matInput [formControl]="searchControl" appInputRestriction="ALPHA_NUMERIC" name="busqueda" />
            </mat-form-field>
          </div>
          <div class="row mt-2">
            <div class="col-md-3"></div>
            <div class="col-md-9 container-filters">
              <span class="filtro-busqueda" matTooltip="" *ngIf="fecIni && fecFin">Rango de fechas <span class="close" (click)="btnCleanFilters('fechas')">x</span></span>
              <span class="filtro-busqueda" matTooltip="" *ngIf="campus">Campus <span class="close" (click)="btnCleanFilters('campus')">x</span></span>
              <span class="filtro-busqueda" matTooltip="" *ngIf="areaResp">Área responsable <span class="close" (click)="btnCleanFilters('areaResp')">x</span></span>
              <span class="filtro-busqueda" matTooltip="" *ngIf="estatus">Estatus <span class="close" (click)="btnCleanFilters('estatus')">x</span></span>            
              <button id="btnParams" class="btnParams" mat-raised-button (click)="drawer.toggle()">Elegir
                parámetros</button>
            </div>  
          </div>
          <div class="row pb-4 mt-4">
            <div class="col-md-12 container__table mat-elevation-z8">
              <table mat-table [dataSource]="dataSource">
                <ng-container matColumnDef="cicloEvaluacionDescripcion">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef>Ciclo de evaluación</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row">Ciclo:
                    {{row.cicloEvaluacionDescripcion}} </td>
                </ng-container>
                <ng-container matColumnDef="titulo">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef>Título</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row">{{row.titulo}}</td>
                </ng-container>
                <ng-container matColumnDef="fechaCreacion">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef>Fecha de creación</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row">
                    {{obtenerFechaFormateada(row.fechaCreacion)}}</td>
                </ng-container>
                <ng-container matColumnDef="fechaEnvio">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef>Fecha de envío</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row">
                    {{obtenerFechaFormateada(row.fechaEnvio)}}</td>
                </ng-container>
                <ng-container matColumnDef="usuarioEnvioNombre">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef>Usuario de envío</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row">{{row.usuarioEnvioNombre}}
                  </td>
                </ng-container>
                <ng-container matColumnDef="destinatarios">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef>Destinatarios</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row" class="dateEC">
                    {{row.destinatarios}}</td>
                </ng-container>
                <ng-container matColumnDef="estatusDescripcion">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef> Estatus</th>
                  <td mat-cell class="table__cell table__cell-name" *matCellDef="let row"
                    [ngClass]="{'status-sent':row.estatusDescripcion=='Enviada','status-cancel':row.estatusDescripcion=='Cancelada'}">
                    {{row.estatusDescripcion}}</td>
                </ng-container>
                <ng-container matColumnDef="edit">
                  <th mat-header-cell class="table__header table__cell-name" *matHeaderCellDef> Acciones </th>
                  <td mat-cell class="table__cell table__cell-name" class="table__cell table__cell--actions"
                    *matCellDef="let row; let index = index">
                    <div class="d-flex text-right">
                      <button mat-button matTooltip="Editar" (click)="editRecord(row)"
                        *ngIf="row.estatusDescripcion=='Guardada'">
                        <mat-icon class="edit__icon">edit</mat-icon>
                      </button>
                      <button mat-button matTooltip="Cancelar" (click)="cancelRow(row)"
                        *ngIf="row.estatusDescripcion=='Enviada'">
                        <mat-icon class="eye__icon">cancel</mat-icon>
                      </button>
                      <div class="btn-invisible" *ngIf="row.estatusDescripcion!='Enviada'">&nbsp;</div>
                      <!--button mat-button matTooltip="Eliminar" (click)="deleteRow(row)" *ngIf="row.estatusDescripcion!='Enviada'">
                          <mat-icon class="delete__icon">delete_forever</mat-icon>
                      </button-->
                      <button mat-button matTooltip="Ver" (click)="showRecord(row)">
                        <mat-icon class="eye__icon">remove_red_eye</mat-icon>
                      </button>
                      <button mat-button matTooltip="Duplicar" (click)="duplicarRecord(row)" *ngIf="row.estatusDescripcion!='Cancelada'">
                        <mat-icon class="eye__icon">content_copy</mat-icon>
                      </button>
                      <div class="btn-invisible" *ngIf="row.estatusDescripcion=='Cancelada'">&nbsp;</div>
                      
                      <button mat-button matTooltip="Seguimiento" (click)="notiTrack(row)" *ngIf="row.estatusDescripcion=='Enviada'">
                        <mat-icon class="eye__icon">swap_calls</mat-icon>
                      </button>
                      <div class="btn-invisible" *ngIf="row.estatusDescripcion!='Enviada'">&nbsp;</div>
                    </div>
                  </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
              </table>
              <ng-template [ngIf]="dataSource.data.length === 0">
                <p class="empty-table mt-4">No hay datos para mostrar</p>
              </ng-template>
              <mat-paginator #paginator [length]="length" [pageIndex]="pageIndex" [pageSize]="pageSize"
                [pageSizeOptions]="[25, 50, 75, 100]" class="ml-auto" showFirstLastButtons
                (page)="paginatorChange($event)"></mat-paginator>
            </div>
          </div>
        </div>
      </main>
    </div>
  </mat-drawer-content>
</mat-drawer-container>